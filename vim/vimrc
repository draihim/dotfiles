let mapleader = ","
filetype plugin indent on
nnoremap Y y$
syntax on
set noshowmode
set mouse=a
set term=screen-256color
set number
set relativenumber
set hidden nobackup nowritebackup
set backspace=indent,eol,start
set hls is " highlight matches and start search while typing
set showcmd " show incomplete commands in the status bar
set history=100
set autoindent "indents using whitespaces
set laststatus=2 " make file status etc. always visible
set cursorline
set smartindent
set ignorecase
set scrolloff=8
set expandtab
set t_Co=256
set clipboard^=unnamed
set listchars=tab:▸\ ,trail:•,extends:❯,precedes:❮
set showbreak=↪\
set splitbelow splitright
set signcolumn=number
set guioptions=
" use rg for grepping
set grepprg=rg\ --vimgrep\ --fixed-strings

nnoremap <Down> gj
nnoremap <Up> gk
vnoremap <Down> gj
vnoremap <Up> gk
nnoremap j gj
nnoremap k gk

nnoremap <leader>> <C-W>>
nnoremap <leader>< <C-W><

"remove hanging whitespace
nnoremap <leader>s :%s/\s\+$//e<CR>

" open a new vertical split window with <leader> w
nnoremap <leader>w <C-w>v<C-w>l
nnoremap <leader>v :vnew<CR>

"insert a timestamp in default date format
nnoremap <leader>dt :put =strftime('%c')<CR>

" Simple re-format for minified Javascript
command! UnMinify call UnMinify()
function! UnMinify()
    %s/{\ze[^\r\n]/{\r/g
    %s/){/) {/g
    %s/};\?\ze[^\r\n]/\0\r/g
    %s/;\ze[^\r\n]/;\r/g
    %s/[^\s]\zs[=&|]\+\ze[^\s]/ \0 /g
    normal ggVG=
endfunction

" plugins
call plug#begin('~/.vim/plugged')
Plug 'HerringtonDarkholme/yats.vim'
Plug 'Raimondi/delimitMate'
Plug 'ap/vim-css-color'
Plug 'benmills/vimux'
Plug 'bling/vim-airline'
Plug 'christoomey/vim-tmux-navigator'
Plug 'codota/tabnine-vim'
Plug 'godlygeek/tabular'
Plug 'jlanzarotta/bufexplorer'
Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }
Plug 'junegunn/fzf.vim'
Plug 'junegunn/vim-slash'
Plug 'tpope/vim-commentary'
Plug 'tpope/vim-endwise'
Plug 'tpope/vim-fugitive'
Plug 'tpope/vim-repeat'
Plug 'tpope/vim-surround'
Plug 'tpope/vim-unimpaired'
Plug 'tpope/vim-sleuth'
Plug 'w0rp/ale'
" colors
Plug 'AlessandroYorba/Alduin'
Plug 'AlessandroYorba/Despacio'
Plug 'fcpg/vim-farout'
call plug#end()

" colorschemes!
set bg=dark
colorscheme gruvbox

set statusline+=%#warningmsg#
" set statusline+=%{SyntasticStatuslineFlag()}
" set statusline+=%*

autocmd Filetype gitcommit setlocal spell textwidth=72  " set columns to 72 on git commits

autocmd QuickFixCmdPost [^l]* nested cwindow
autocmd QuickFixCmdPost    l* nested lwindow

"ale
let g:ale_fix_on_save = 1
let g:ale_open_list = 1

let g:ale_linters = {
\  'python': ['flake8'],
\  'rust': ['rls'],
\  'javascript': ['eslint'],
\  'typescript': ['eslint'],
\}
let g:ale_fixers = {
\  '*': ['remove_trailing_lines', 'trim_whitespace'],
\  'python': ['black'],
\  'rust': ['rustfmt'],
\  'javascript': ['prettier'],
\}
let g:ale_rust_rls_toolchain = 'stable'


noremap <silent> H :ALEHover<CR>
noremap <silent> R :ALEFindReferences<CR>
noremap <silent> Q :ALEGoToDefinition<CR>

"vimux
 " Prompt for a command to run
 map <Leader>tr :VimuxPromptCommand<CR>
 " Run last command executed by VimuxRunCommand
 map <Leader>tt :VimuxRunLastCommand<CR>

" test fzf mappings
nnoremap <silent> <Leader>/ :Rg<Cr>
nnoremap <c-p> :Files<CR>
nnoremap <silent> <Leader>f :Files<Cr>
nnoremap <silent> <Leader>F :GFiles<Cr>

nnoremap <silent> <Leader>b :Buffers<Cr>
nnoremap <silent> <Leader>h :History<Cr>

nnoremap <silent> <Leader>l :Lines<Cr>
nnoremap <silent> <Leader>L :BLines<Cr>

nnoremap <silent> <Leader>t :Tags<Cr>
nnoremap <silent> <Leader>T :BTags<Cr>
